<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>Pinyin Input Method</title>
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <div class="main-layout">
            <div class="toolbar">
                <button id="l-hist-btn" class="btn btn-toggle" onclick="toggleHistoryPanel()">剪切板</button>
                <div class="toolbar-divider"></div>
                
                <div id="practice-toolbar-left" class="practice-toolbar">
                </div>

                <button id="practice-mode-btn" class="btn btn-toggle" onclick="startPracticeMode()">练习模式</button>
                <button id="exit-practice-mode-btn" class="btn btn-danger" onclick="exitPracticeMode()" style="display: none;">退出练习</button>
                
                <div style="margin-left: auto; display: flex; gap: 10px;">
                    <button id="theme-toggle-btn" class="btn btn-toggle" onclick="toggleTheme()">深色模式</button>
                    <a href="https://github.com/123qweraz/webime" target="_blank" class="btn btn-github">GitHub Star</a>
                    <button class="btn btn-toggle" onclick="openSettingsSidebar()">词典设置</button>
                </div>
            </div>

            <div class="content-area">
                <div class="history-panel" id="historyPanel">
                    <div class="history-header">
                        <span>剪切板历史</span>
                        <button onclick="clearHistory()" class="btn btn-toggle btn-sm" style="font-size: 11px;">清空</button>
                    </div>
                    <ul id="historyList" class="history-list"></ul>
                </div>
                
                <div class="center-container">
                    <div class="output-card" id="output-card">
                        <div id="output-area" spellcheck="false" contenteditable="true"></div>
                        <div class="control-group">
                            <button id="search-btn" class="btn btn-toggle" style="background: #4285f4; color: white;" onclick="searchGoogle()">搜索 (Ctrl+G)</button>
                            <button class="btn btn-toggle active" style="background: #222; color: white;" onclick="archiveAndCopy()">归档并复制</button>
                        </div>
                    </div>

                    <div id="practice-container">
                        <div id="practice-directory" class="practice-directory-view" style="display: none;">
                            <!-- Chapters will be rendered here -->
                        </div>

                        <div id="card-left" class="practice-card-slot">
                            <div class="practice-card-content">
                                <div class="card-rotate-btn" title="旋转 (Rotate)">↻</div>
                                <div class="card-face card-front">
                                    <div class="pinyin-display"></div>
                                    <div class="hanzi-display"></div>
                                </div>
                                <div class="card-face card-back">
                                    <div class="pinyin-display" style="visibility: hidden;"></div>
                                    <div class="hanzi-display"></div>
                                    <div class="en-display"></div>
                                </div>
                            </div>
                        </div>
                        <div id="card-center" class="practice-card-slot">
                            <div class="practice-card-content">
                                <div class="card-rotate-btn" title="旋转 (Rotate)">↻</div>
                                <div class="card-face card-front">
                                    <div class="pinyin-display"></div>
                                    <div class="hanzi-display"></div>
                                </div>
                                <div class="card-face card-back">
                                    <div class="pinyin-display" style="visibility: hidden;"></div>
                                    <div class="hanzi-display"></div>
                                    <div class="en-display"></div>
                                </div>
                            </div>
                        </div>
                        <div id="card-right" class="practice-card-slot">
                            <div class="practice-card-content">
                                <div class="card-rotate-btn" title="旋转 (Rotate)">↻</div>
                                <div class="card-face card-front">
                                    <div class="pinyin-display"></div>
                                    <div class="hanzi-display"></div>
                                </div>
                                <div class="card-face card-back">
                                    <div class="pinyin-display" style="visibility: hidden;"></div>
                                    <div class="hanzi-display"></div>
                                    <div class="en-display"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="practice-footer" style="display: none; justify-content: center; align-items: center; gap: 20px; margin-top: 20px;">
                        <button id="back-to-dir-btn" class="btn btn-toggle" onclick="showPracticeDirectory()">章节目录</button>
                        <button id="toggle-browse-btn" class="btn btn-toggle" onclick="toggleBrowseMode()">浏览模式</button>
                        <button id="toggle-pinyin-btn" class="btn btn-toggle" onclick="togglePinyinHint()">显示拼音 (F2)</button>
                        <button id="play-sound-btn" class="btn btn-toggle" onclick="speakCurrentWord()">朗读 (F3)</button>
                        <button id="toggle-tts-btn" class="btn btn-toggle" onclick="toggleAutoTTS()">自动朗读</button>
                    </div>

                    <div class="resizer-v" id="center-v-resizer"></div>

                    <div class="input-card focused" id="input-container">
                        <div class="input-status-bar">
                            <div id="buffer-display"></div>
                            <div id="page-counter"></div>
                        </div>
                        <div id="main-candidates"></div>
                        <input type="text" id="hidden-input" autocomplete="off" />
                    </div>
                </div>
            </div>
        </div>

        <div id="loading-overlay">
            <div id="loading-spinner"></div>
            <p>正在初始化...</p>
        </div>
        <div id="inputMethodToast" class="input-method-toast"></div>

        <div id="settings-sidebar-backdrop" class="sidebar-backdrop" onclick="closeSettingsSidebar()"></div>
        <div id="settings-sidebar" class="settings-sidebar">
            <div class="sidebar-header">
                <h3>词典方案设置</h3>
                <button class="sidebar-close-btn" onclick="closeSettingsSidebar()">&times;</button>
            </div>
            
            <div class="sidebar-tabs">
                <div id="tab-btn-chinese" class="sidebar-tab active" data-tab="chinese" onclick="switchDictTab('chinese')">中文</div>
                <div id="tab-btn-japanese" class="sidebar-tab" data-tab="japanese" onclick="switchDictTab('japanese')">日语</div>
                <div id="tab-btn-english" class="sidebar-tab" data-tab="english" onclick="switchDictTab('english')">英语</div>
                <div id="tab-btn-user" class="sidebar-tab" data-tab="user" onclick="switchDictTab('user')">用户</div>
                <div id="tab-btn-practice" class="sidebar-tab" data-tab="practice" onclick="switchDictTab('practice')" style="display: none;">练习</div>
            </div>
            
            <div class="sidebar-content">
                <div id="tab-chinese" class="tab-content active"></div>
                <div id="tab-japanese" class="tab-content"></div>
                <div id="tab-english" class="tab-content"></div>
                <div id="tab-user" class="tab-content"></div>
                <div id="tab-practice" class="tab-content"></div>
            </div>
        </div>

        <!-- Scripts -->
        <script src="js/config.js"></script>
        <script src="js/utils.js"></script>
        <script src="js/trie.js"></script>
        <script src="js/history.js"></script>
        <script src="js/practice.js"></script>
        <script src="js/dict-manager.js"></script>
        <script src="js/ime.js"></script>
        <script src="js/main.js"></script>
    </body>
</html>
