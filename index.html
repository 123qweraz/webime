<!doctype html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>Pinyin Input Method</title>
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <div class="main-layout">
            <div class="toolbar">
                <button id="l-hist-btn" class="btn btn-toggle" onclick="toggleHistoryPanel()">剪切板</button>
                <div class="toolbar-divider"></div>
                <a href="hanzi_explorer.html" class="btn btn-toggle" target="_blank">汉字浏览器</a>
                
                <div id="practice-toolbar-left" class="practice-toolbar">
                </div>

                <button id="practice-mode-btn" class="btn btn-toggle" onclick="startPracticeMode()">练习模式</button>
                <button id="exit-practice-mode-btn" class="btn btn-danger" onclick="exitPracticeMode()" style="display: none;">退出练习</button>
                
                <div style="margin-left: auto; display: flex; gap: 10px;">
                    <button id="theme-toggle-btn" class="btn btn-toggle" onclick="toggleTheme()">深色模式</button>
                    <a href="https://github.com/123qweraz/webime" target="_blank" class="btn btn-github">GitHub Star</a>
                    <button class="btn btn-toggle" onclick="openDictModal()">词典设置</button>
                </div>
            </div>

            <div class="content-area">
                <div class="history-panel" id="historyPanel">
                    <div class="history-header">
                        <span>剪切板历史</span>
                        <button onclick="clearHistory()" class="btn btn-toggle btn-sm" style="font-size: 11px;">清空</button>
                    </div>
                    <ul id="historyList" class="history-list"></ul>
                </div>
                
                <div class="center-container">
                    <div class="output-card" id="output-card">
                        <div id="output-area" class="locked" spellcheck="false"></div>
                        <div class="control-group">
                            <button id="edit-mode-btn" class="btn btn-toggle" onclick="toggleEditMode()">锁定模式</button>
                            <button class="btn btn-toggle active" style="background: #222; color: white;" onclick="archiveAndCopy()">归档并复制</button>
                        </div>
                    </div>

                    <!-- Practice Progress Area -->
                    <div id="practice-info-bar">
                        <div style="display: flex; align-items: center; gap: 20px; width: 100%; justify-content: center;">
                            <select id="practice-dict-select" class="btn"></select>
                            
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span id="practice-progress-text">0 / 0</span>
                                <div id="progress-container" style="width: 200px;"><div id="progress-bar"></div></div>
                            </div>
                        </div>
                    </div>

                    <div id="practice-container">
                        <div id="card-left" class="practice-card-slot">
                            <div class="practice-card-content"><div class="pinyin-display"></div><div class="hanzi-display"></div></div>
                        </div>
                        <div id="card-center" class="practice-card-slot">
                            <div class="practice-card-content"><div class="pinyin-display"></div><div class="hanzi-display"></div></div>
                        </div>
                        <div id="card-right" class="practice-card-slot">
                            <div class="practice-card-content"><div class="pinyin-display"></div><div class="hanzi-display"></div></div>
                        </div>
                    </div>

                    <div id="practice-footer" style="display: none; justify-content: center; align-items: center; gap: 20px; margin-top: 20px;">
                        <div class="practice-jump-box">
                            <span style="font-size: 12px; color: var(--text-sec);">跳转:</span>
                            <input type="number" id="practice-jump-input" class="practice-jump-input" placeholder="序号" onkeydown="if(event.key==='Enter') jumpToWord(this.value)">
                        </div>

                        <button id="toggle-pinyin-btn" class="btn btn-toggle" onclick="togglePinyinHint()">显示拼音 (F2)</button>
                    </div>

                    <div class="resizer-v" id="center-v-resizer"></div>

                    <div class="input-card" id="input-container">
                        <!-- Correction Wrapper -->
                        <div id="correction-wrapper">
                            <div class="correction-header">修正模式 (Ctrl + I)</div>
                            <input type="text" id="correction-input" autocomplete="off" placeholder="输入拼音短语，用空格分隔..." />
                            <div class="correction-footer">
                                <span>Enter 提交 / Esc 取消</span>
                                <span>支持多词同步修正</span>
                            </div>
                        </div>

                        <div class="input-status-bar">
                            <div id="buffer-display"></div>
                            <div id="page-counter"></div>
                        </div>
                        <div id="main-candidates"></div>
                        <input type="text" id="hidden-input" autocomplete="off" />
                    </div>
                </div>
            </div>
        </div>

        <div id="loading-overlay">
            <div id="loading-spinner"></div>
            <p>正在初始化...</p>
        </div>
        <div id="inputMethodToast" class="input-method-toast"></div>

        <div id="dict-modal" class="modal-overlay" style="display: none">
            <div class="modal-content">
                <button class="modal-close-btn" onclick="closeDictModal()">&times;</button>
                <div class="modal-header" style="margin-bottom: 25px; border-bottom: none; padding: 0;">
                    <h3 style="font-size: 22px; font-weight: 800;">词典方案设置</h3>
                </div>
                <div class="modal-tabs">
                    <div class="modal-tab active" data-tab="chinese" onclick="switchDictTab('chinese')">中文</div>
                    <div class="modal-tab" data-tab="japanese" onclick="switchDictTab('japanese')">日语</div>
                    <div class="modal-tab" data-tab="user" onclick="switchDictTab('user')">用户</div>
                </div>
                <div class="modal-body">
                    <div id="tab-chinese" class="tab-content active"></div>
                    <div id="tab-japanese" class="tab-content"></div>
                    <div id="tab-user" class="tab-content"></div>
                </div>
            </div>
        </div>

        <!-- Scripts -->
        <script src="js/config.js"></script>
        <script src="js/utils.js"></script>
        <script src="js/trie.js"></script>
        <script src="js/history.js"></script>
        <script src="js/practice.js"></script>
        <script src="js/dict-manager.js"></script>
        <script src="js/ime.js"></script>
        <script src="js/main.js"></script>
    </body>
</html>
